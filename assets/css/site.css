/* Flexbox page layout */
:root {
  /* Layout */
  --max-width: 87.5rem; /* 1400px */
  --container-pad: 0.5rem;
  --container-pad-sm: 0.75rem;

  /* Typography */
  --font-family-sans: "Source Sans Pro", Arial, sans-serif;

  /* Colors */
  --color-text: #222;
  --color-dark: #1b1b1b;
  --color-inverse: #ffffff;
  --color-accent: #0071bc;
  --color-muted: #f0f0f0;
  --bg-dark: #222;

  /* Components */
  --card-thumb-h: 8.75rem; /* 140px */
  --subnav-gap: 0.75rem;
  --subnav-pad: 0.25rem 0.5rem;
  --subnav-link-pad-sm: 0.5rem 1rem;
  --subnav-link-pad-lg: 0.75rem 1rem;
  --subnav-link-radius: 0.375rem;
  --subnav-underline-thickness: 0.1875rem; /* 3px */

  /* Focus / shadows */
  --focus-outline-width: 0.125rem; /* 2px */
  --focus-outline-offset: 0.125rem; /* 2px */
  --shadow-sm: 0 0.375rem 1.25rem rgba(0, 0, 0, 0.08); /* 6px / 20px */

  /* Logo sizes */
  --logo-small-h: 1.8rem;
  --logo-med-h: 2.2rem;
  --logo-default-h: 3rem; /* 48px */

  /* Note: CSS custom properties are not supported inside @media feature expressions in current browsers; use rem/em when writing queries. */
}

/* Global reset: predictable box-sizing */
*, *::before, *::after {
  box-sizing: border-box;
}

html,
body {
  display: flex;
  flex-direction: column;
  min-height: 100vh;
  height: 100%;
  scrollbar-gutter: stable;
  overflow-y: scroll;
  color: var(--color-text);
  font-family: var(--font-family-sans);
}

/* Main flexes to fill space */
main {
  flex: 1 0 auto;
}

/* Container for consistent horizontal alignment */
.container {
  max-width: var(--max-width);
  margin: 0 auto;
  padding-left: var(--container-pad);
  padding-right: var(--container-pad);
  width: 100%;
}

/* Header: scoped header foreground + compatibility override */
.usa-header.bg-primary-darker {
  --header-foreground: var(--color-inverse);
}
header.usa-header.bg-primary-darker .usa-navbar {
  max-width: none !important;
}

/* === Header: dark background, white text === */
.usa-header.bg-primary-darker .usa-logo__text {
  color: var(--header-foreground) !important;
  white-space: nowrap;
}

/* Inverse nav links (white text on dark header) - simplified selector */
.usa-header.bg-primary-darker .usa-nav__primary a {
  color: var(--header-foreground) !important;
  text-decoration: none;
}

/* Keep keyboard focus visible, but avoid removing focus for mouse interactions */
.usa-header.bg-primary-darker .usa-nav__primary a:focus:not(:focus-visible) {
  outline: none;
}

/* Small, scoped fixes so the mobile menu is visible on dark headers and the content is higher contrast */
.usa-header.bg-primary-darker .usa-menu-btn {
  color: var(--header-foreground) !important;
  background: transparent !important;
  border-color: transparent !important;
  z-index: 9999;
}
.usa-header.bg-primary-darker .usa-nav {
  background: transparent !important; /* let the header background show through */
  color: var(--header-foreground) !important;
  border-top: none !important;
  box-shadow: none !important;
  z-index: 9999;
}
.usa-header.bg-primary-darker .usa-nav__primary a,
.usa-header.bg-primary-darker .usa-nav__close {
  color: var(--header-foreground) !important;
}

/* Make sure the mobile nav panel sits above other layout pieces */
.usa-header .usa-nav {
  z-index: 9999;
}

/* Slightly increase content contrast when the site is rendered with lighter base styles */
.usa-prose {
  color: var(--color-text) !important;
}

/* Fix: ensure footer and identifier are not clipped by overflow rules */
/* Make footer background full-bleed while keeping inner content aligned with .container */
footer.usa-footer {
  margin-top: auto;
  overflow: visible !important; /* allow identifier to escape clipping */
  background-color: transparent; /* keep base footer transparent so inner sections can be full-bleed */
}

/* Secondary fullwidth area holds the visible footer background */
.usa-footer__secondary-fullwidth {
  width: 100%;
  box-sizing: border-box;
  background-color: var(--color-muted);
}
.usa-footer__secondary-fullwidth .container {
  padding-top: 0.5rem;
  padding-bottom: 0.5rem;
}
.usa-footer__secondary-fullwidth .usa-footer__secondary-section {
  padding: 0;
  background-color: transparent;
}
.usa-footer__secondary-fullwidth .usa-footer__copyright {
  margin: 0;
  font-size: 0.95rem;
  line-height: 1.25;
}

/* Override USWDS .usa-intro to use sans-serif font */
.usa-intro {
  font-family: var(--font-family-sans) !important;
}

.usa-section {
  padding-top: 1em !important;
  padding-bottom: 1em !important;
}

/* USWDS prose and font styling for main content */
.usa-prose {
  font-family: var(--font-family-sans);
  font-size: 1rem;
  line-height: 1.5;
  color: var(--color-text);
}
.usa-prose h1,
.usa-prose h2,
.usa-prose h3,
.usa-prose h4,
.usa-prose h5,
.usa-prose h6 {
  font-family: var(--font-family-sans);
  font-weight: 700;
  color: #1a1a1a;
  margin-top: 2rem;
  margin-bottom: 1rem;
}
.usa-prose h1 {
  margin-top: 0rem;
}
.usa-prose p {
  margin-bottom: 1.25rem;
  font-size: 1rem;
  max-width: 100%;
  width: 100%;
}
.usa-prose>ul li {
  max-width: 100% !important;
}

/* Make images responsive by default (mobile-first) */
img {
  max-width: 100%;
  height: auto;
  display: block;
}

/* Neutralize USWDS left padding/margin for logo alignment (consolidated) */
.usa-logo,
.usa-navbar,
.usa-nav-container {
  padding-left: 0 !important;
  margin-left: 0 !important;
}

/* Keep remaining .usa-nav-container specifics separate */
.usa-nav-container {
  padding-right: 0 !important;
  margin-right: 0 !important;
  max-width: 100% !important;
}

.usa-card__heading,
.usa-card__body p {
  text-align: center;
}
.usa-card__footer {
  display: flex;
  flex-direction: column;
  align-items: center;
  margin-top: auto; /* Footer pushed to bottom */
}
.usa-card__media {
  display: flex;
  justify-content: center;
  align-items: center;
  background: var(--bg-dark);
  padding: 0.25rem; /* reduced padding so the image takes up less vertical space */
}
.solution-card {
  width: 100%;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  box-sizing: border-box;
}
/* Keep card heights even so footers align */
.card--equal {
  display: flex;
  flex-direction: column;
  height: 100%;
  box-sizing: border-box;
}
/* Ensure the inner container stretches and uses flex layout so .usa-card__body can grow */
.usa-card.card--equal,
.usa-card.card--equal .usa-card__container {
  display: flex;
  flex-direction: column;
  height: 100%;
}
/* Allow the body to grow and push the footer down */
.usa-card__body {
  flex: 1 1 auto;
}
/* Compact thumbnail: fixed shorter height, center the full image inside without cropping */
.card-thumb {
  height: var(--card-thumb-h);
  overflow: hidden;
  border-radius: 0.5rem;
  display: flex;
  align-items: center;
  justify-content: center;
  background: var(--bg-dark);
  aspect-ratio: 16 / 9;
}
/* Avoid cropping important parts of thumbnails: show the whole image and center it */
.card-thumb img {
  width: 100%;
  height: 100%;
  max-height: 100%;
  max-width: 100%;
  object-fit: contain; /* fill the thumbnail area */
  object-position: center;
  display: block;
  background-color: var(--bg-dark); /* keep the same background as earlier */
}
/* Tidy summaries to ~3 lines (preview) */
.card-summary {
  display: -webkit-box;
  -webkit-line-clamp: 3;
  line-clamp: 3;
  -webkit-box-orient: vertical;
  overflow: hidden;
}
/* Optional, subtle hover without breaking a11y */
.usa-card:hover .usa-card__container {
  box-shadow: var(--shadow-sm);
}
/* Modifier: shrink or constrain card width when used in inline contexts */
.usa-card.card--shrink {
  display: inline-flex;
  width: auto;
  height: auto;
  box-sizing: border-box;
  vertical-align: top;
}
.usa-card.card--shrink .usa-card__container {
  display: flex;
  flex-direction: column;
  height: auto;
}
.usa-card.card--shrink .usa-card__body {
  flex: 0 1 auto; /* allow body to size naturally */
}
.usa-card.card--shrink .usa-card__footer {
  margin-top: 0;
}
/* Compact card adjustments: reduce vertical spacing so cards are shorter */
.card--equal .usa-card__container {
  padding: 0.5rem; /* tighten container padding */
}
.card--equal .usa-card__header {
  padding-bottom: 0.25rem;
}
.card--equal .usa-card__heading {
  font-size: 1.05rem;
  margin: 0 0 0.25rem 0;
}
.card--equal .usa-card__body {
  padding-top: 0;
  padding-bottom: 0.25rem; /* reduce bottom padding to shrink the card height */
}
.card--equal .usa-card__footer {
  padding-top: 0.25rem;
}
/* Remove default paragraph margins inside equal-height cards to avoid extra whitespace */
.card--equal .usa-card__body p {
  margin: 0; /* rely on .usa-card__body padding for spacing */
}

/* Traditional nav-bar style for tabs (consolidated) */
.mgat-subnav {
  background: transparent;
  border: none;
  border-radius: 0;
  padding: 0.25rem 0;
  margin-bottom: 1rem;
}
/* Horizontal list like a nav bar */
.mgat-subnav__list {
  display: flex;
  gap: var(--subnav-gap);
  padding: var(--subnav-pad);
  list-style: none;
  margin: 0;
  flex-wrap: wrap;
  align-items: center;
  overflow-x: auto; /* allow horizontal scrolling on small screens */
  -webkit-overflow-scrolling: touch;
}
/* Items */
.mgat-subnav__item {
  display: inline-flex;
  margin: 0;
}
/* Links styled like header links but in-page (consolidated rules) */
.mgat-subnav__link {
  display: inline-flex;
  align-items: center;
  padding: var(--subnav-link-pad-sm);
  color: var(--color-dark);
  text-decoration: none;
  border-radius: var(--subnav-link-radius);
  border-bottom: var(--subnav-underline-thickness) solid transparent;
  transition: background 0.12s ease, color 0.12s ease, border-bottom-color 0.12s ease;
}
/* Hover/focus states (USWDS-ish) */
.mgat-subnav__link:hover {
  background: rgba(0, 0, 0, 0.04);
  text-decoration: none;
}
/* Keep focus-visible for keyboard users, avoid removing focus for mouse clicks */
.mgat-subnav__link:focus {
  outline: none;
  box-shadow: none;
  outline-offset: var(--focus-outline-offset);
}
.mgat-subnav__link:focus-visible {
  outline: var(--focus-outline-width) solid #2491ff;
  outline-offset: var(--focus-outline-offset);
}
/* Active: underline effect + stronger weight */
.mgat-subnav__link.is-active,
.mgat-subnav__link[aria-selected="true"] {
  color: var(--color-dark);
  border-bottom-color: var(--color-accent); /* accent underline for active */
  font-weight: 700;
  box-shadow: none; /* disable any earlier inset underline implementations */
  background: transparent;
  border-radius: 0;
}
/* Panels: JS will [hidden] the inactive ones */
.mgat-subnav__panel[hidden] {
  display: none !important;
}
/* Optional: make the subnav sticky under your header */
.mgat-subnav.is-sticky {
  position: sticky;
  top: 0; /* adjust if your header is fixed */
  z-index: 10;
  background: #fff;
}

.mgat-solution-heading {
  font-size: 1.5rem;
  font-weight: 700;
  margin-bottom: 1rem;
  margin-top: 0rem;
}

.usa-identifier {
  overflow: visible !important;
  z-index: 0;
}
/* Add vertical padding so the logo doesn't bump up against the top */
.usa-identifier .usa-identifier__container {
  padding-top: 0.75rem;
  padding-bottom: 0.75rem;
}
/* Make identifier logo + identity sit side-by-side by default */
.usa-identifier .usa-identifier__brand {
  display: flex;
  flex-direction: row; /* explicit default: keep logo + title side-by-side */
  align-items: center;
  gap: 1rem;
  flex-wrap: nowrap;
}
.usa-identifier .usa-identifier__logo {
  flex: 0 0 auto;
  display: inline-flex;
  align-items: center;
}
.usa-identifier .usa-identifier__logo img {
  height: var(--logo-default-h);
  width: auto;
  display: block;
}
.usa-identifier .usa-identifier__identity {
  flex: 1 1 auto;
  margin-top: 0;
}

/* Mobile-first: small-screen adjustments grouped together */
@media (max-width: 40rem) {
  /* Identifier: stack brand vertically on small screens */
  .usa-identifier .usa-identifier__brand {
    flex-direction: column;
    align-items: flex-start;
  }
  .usa-identifier .usa-identifier__identity {
    margin-top: 0.5rem;
  }

  /* Reduce header logo size and allow the site title to wrap/truncate gracefully */
  .usa-header .usa-logo__text.brand {
    font-size: 1rem;
    line-height: 1;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }
  .usa-header .usa-logo__text.brand img {
    height: var(--logo-small-h) !important; /* override inline height for small screens */
    width: auto;
    display: inline-block;
  }

  /* Keep nav and logo aligned without causing horizontal overflow */
  .usa-nav-container {
    padding-left: 0.25rem !important;
    padding-right: 0.25rem !important;
  }
  .usa-navbar {
    align-items: center;
  }

  /* Slightly reduce horizontal padding on small viewports so content has more space */
  .container {
    padding-left: var(--container-pad-sm);
    padding-right: var(--container-pad-sm);
  }

  /* Slightly smaller body text for narrow screens and tighter spacing */
  .usa-prose {
    font-size: 0.95rem;
  }
  .usa-prose p {
    margin-bottom: 1rem;
  }

  /* Ensure footer inner container has breathing room on mobile */
  .usa-footer__secondary-fullwidth .container {
    padding-left: 0.75rem;
    padding-right: 0.75rem;
  }

  /* Ensure the top 'Under construction' banner wraps and doesn't force horizontal scroll */
  header.usa-header > div[role="status"] {
    font-size: 0.9rem;
    padding: 0.5rem 0.5rem;
    white-space: normal;
    box-sizing: border-box;
  }

  /* Small accessibility tweak: ensure focus-visible outlines remain visible on small screens */
  .mgat-subnav__link:focus-visible {
    outline-width: 0.1875rem; /* 3px */
  }

  /* Make the mobile nav panel clearly visible on dark headers */
  .usa-header.bg-primary-darker .usa-nav {
    background: var(--bg-dark) !important;
    color: var(--header-foreground) !important;
  }

  /* Ensure nav links are readable and don't inherit light backgrounds */
  .usa-header.bg-primary-darker .usa-nav__primary .usa-nav__link {
    color: var(--header-foreground) !important;
    background: transparent !important;
  }

  /* Subtle hover/focus state that keeps contrast high */
  .usa-header.bg-primary-darker .usa-nav__primary .usa-nav__link:hover,
  .usa-header.bg-primary-darker .usa-nav__primary .usa-nav__link:focus {
    background: rgba(255,255,255,0.06) !important;
    color: var(--header-foreground) !important;
  }

  /* Ensure the mobile nav panel and menu button sit above other components */
  .usa-header .usa-nav,
  .usa-header .usa-nav.is-open,
  .usa-header .usa-nav[aria-hidden="false"] {
    z-index: 99999 !important;
  }
  .usa-header .usa-menu-btn {
    z-index: 100001 !important;
  }
}

/* Stronger override: force side-by-side on medium+ screens */
@media (min-width: 40rem) {
  .usa-identifier .usa-identifier__brand {
    display: flex !important;
    flex-direction: row !important;
    align-items: center !important;
    gap: 1rem !important;
    flex-wrap: nowrap !important;
  }
  .usa-identifier .usa-identifier__logo {
    flex: 0 0 auto !important;
    display: inline-flex !important;
    align-items: center !important;
  }
  .usa-identifier .usa-identifier__logo img {
    height: var(--logo-default-h) !important;
    width: auto !important;
    display: block !important;
  }
  .usa-identifier .usa-identifier__identity {
    flex: 1 1 auto !important;
    margin-top: 0 !important;
  }
}

.usa-identifier__logo,
.usa-logo {
  flex: 0 0 auto;
  display: inline-flex;
  align-items: center;
  width: auto;
  max-width: none;
}

/* consolidated: keep logos and title inline */
.usa-logo,
.usa-identifier .usa-identifier__logo,
.usa-logo__text.brand {
  display: inline-flex !important;
  flex: 0 0 auto !important;
  align-items: center !important;
  gap: 0.5rem;
  white-space: nowrap;
  width: auto !important;
  /* max-width: none !important; */
}

.usa-identifier__identity {
  flex: 1 1 auto;
}

/* Identifier (tagline) should be smaller and stack cleanly */
.usa-identifier .usa-identifier__tagline {
  font-size: 0.95rem;
  margin-top: 0.25rem;
}

/* External link indicator: inline SVG icon + spacing */
.external-link-icon {
  display: inline-block;
  width: 0.75rem;
  height: 0.75rem;
  margin-left: 0.25rem;
  vertical-align: text-bottom;
  fill: currentColor;
}

/* Medium screens: gentle adjustments so things don't look cramped */
@media (min-width: 40rem) and (max-width: 60rem) {
  .usa-header .usa-logo__text.brand img {
    height: var(--logo-med-h) !important;
  }
  .container {
    padding-left: 1rem;
    padding-right: 1rem;
  }
}

/* Accessibility: respect reduced motion preference */
@media (prefers-reduced-motion: reduce) {
  * {
    animation-duration: 0.001ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.001ms !important;
    scroll-behavior: auto !important;
  }
}

/* Persona layout: dark, rounded border for persona images */
.page-thumbnail {
  display: block;
  max-width: 100%;
  height: auto;
  border: 0.25rem solid var(--color-dark);
  border-radius: 0.5rem;
  box-shadow: 0 0.25rem 0.5rem rgba(0, 0, 0, 0.06);
}

/* ERD: explicit height so svg height:100% has a reference */
.mermaid {
  height: 20rem; /* adjust as desired */
  min-height: 0;
  width: 100%;
}

/* Make the SVG fill the container and remove max-width constraint */
.mermaid svg {
  display: block;
  width: 100% !important;
  height: 100% !important;
  max-width: none !important;
}

/* Ensure inline <image> elements try to fill their SVG viewport */
.mermaid svg image {
  width: 100% !important;
  height: 100% !important;
  display: block;
}

/* ERD modal styles */
.erd-modal {
  position: fixed;
  inset: 0;
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 9999;
}
.erd-modal.is-open {
  display: flex;
}
.erd-modal__backdrop {
  position: absolute;
  inset: 0;
  background: rgba(0,0,0,0.6);
}
.erd-modal__dialog {
  position: relative;
  background: #fff;
  border-radius: 6px;
  width: min(1400px, 95%); /* widened from 1200px */
  max-height: 90vh;
  height: 90vh; /* keep max height but make the dialog a flex column */
  display: flex;
  flex-direction: column;
  overflow: hidden;
  box-shadow: 0 8px 30px rgba(0,0,0,0.45);
  z-index: 2;
}
.erd-modal__header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0.5rem 0.75rem;
  border-bottom: 1px solid #eee;
}
.erd-modal__close {
  background: transparent;
  border: none;
  font-size: 1.5rem;
  line-height: 1;
  cursor: pointer;
}
.erd-modal__content {
  flex: 1 1 auto; /* take remaining vertical space */
  height: auto;   /* let flex control height */
  padding: 0.5rem 0.75rem;
  overflow: auto;
}
.erd-modal__inner {
  display: flex;
  align-items: stretch;
  width: 100%;
  height: 100%;
}
.erd-modal__inner .mermaid {
  width: 100%;
  height: 100%; /* fill the modal inner area */
  min-height: 0; /* allow flex to shrink on small screens */
}

/* Force SVGs and inner images to stretch inside modal */
.erd-modal__inner svg {
  width: 100% !important;
  height: 100% !important;
}
.erd-modal__inner svg image {
  width: 100% !important;
  height: 100% !important;
}

/* Thin divider between logo/title and nav items (subtle, matches dark header) */
.usa-header.bg-primary-darker .usa-navbar {
  border-bottom: 1px solid rgb(255, 255, 255);
  padding-bottom: 0.1rem; /* keep spacing close to the original look */
  margin-bottom: 0.2rem;
}

/* Ensure menu button is always reachable by pinning it inside the navbar */
.usa-header .usa-navbar {
  position: relative; /* allow absolute positioning of the menu button */
}
.usa-header .usa-menu-btn {
  position: absolute;
  right: 0.5rem;
  top: 50%;
  transform: translateY(-50%);
  z-index: 100001 !important;
}

/* When the nav is a direct child of the header (moved out of the inner .container), keep its inner .container aligned */
.usa-header > .usa-nav .container {
  padding-left: var(--container-pad);
  padding-right: var(--container-pad);
}

@media (max-width: 60rem) {
  /* Reserve more space for the pinned menu button so the site title doesn't run underneath it */
  .usa-header .usa-navbar {
    padding-right: 6rem; /* increased space for the absolute-positioned button */
  }

  /* Allow the branding line to wrap on medium/smaller viewports so it won't overlap the pinned menu */
  .usa-header .usa-logo__text.brand {
    display: inline-block;
    /* max-width: calc(100% - 6rem); */
    overflow: visible; /* allow wrapping/growth */
    text-overflow: unset;
    white-space: normal; /* allow wrapping instead of forcing a single line */
    font-size: 1.2rem; /* slightly smaller on medium screens */
  }

  /* Make the nav overlay dark and readable for small->medium screens */
  .usa-header.bg-primary-darker .usa-nav {
    background: var(--bg-dark) !important;
    color: var(--header-foreground) !important;
  }
  .usa-header.bg-primary-darker .usa-nav__primary .usa-nav__link {
    color: var(--header-foreground) !important;
    background: transparent !important;
  }
  .usa-header.bg-primary-darker .usa-nav__primary .usa-nav__link:hover,
  .usa-header.bg-primary-darker .usa-nav__primary .usa-nav__link:focus {
    background: rgba(255,255,255,0.06) !important;
    color: var(--header-foreground) !important;
  }
}

@media (max-width: 28rem) {
  /* Let the brand wrap to multiple lines and allow the menu button to flow so they don't overlap */
  .usa-header .usa-navbar {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    gap: 0.375rem;
  }
  .usa-header .usa-logo__text.brand {
    display: block;
    white-space: normal; /* allow wrapping */
    /* max-width: 100%; */
    overflow: visible;
    text-overflow: unset;
  }
  .usa-header .usa-menu-btn {
    position: static !important; /* flow with the document rather than overlap the brand */
    margin-left: auto; /* push it to the right of the available row */
    order: 2;
    z-index: 100001 !important;
  }
  .usa-header .usa-navbar .usa-logo {
    order: 1;
    width: auto;
  }
}

/* Ensure navbar has enough vertical room to avoid overlap between brand and pinned menu */
.usa-header .usa-navbar {
  height: auto;
  min-height: 4rem; /* provides vertical breathing room; tweakable */
}

@media (max-width: 60rem) {
  /* Explicit overrides to ensure wrapping in spite of earlier consolidated rules */
  .usa-header .usa-logo {
    /* display: flex !important; */
    align-items: center !important;
    min-width: 0 !important;
    gap: 0.5rem !important;
  }
  .usa-header .usa-logo__text.brand {
    display: block !important;
    flex: 1 1 auto !important;
    min-width: 0 !important;
    white-space: normal !important;
    overflow: visible !important;
    text-overflow: unset !important;
  }
}

.usa-navbar { display: inherit !important; }