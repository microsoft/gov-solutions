---
layout: default
---
<section class="usa-section">
  <div class="grid-container-full">
    <div class="grid-row grid-gap">
      
      <!-- Main content -->
      <main class="grid-col-12 tablet:grid-col-9 usa-prose">
        <div class="grid-row grid-gap">
          <div class="grid-col-12 usa-prose">
            {% include breadcrumbs.html %}
          </div>
        </div>

        <header class="margin-bottom-4">
          <h1 class="usa-prose__heading">{{ page.title }}</h1>
          {% if page.description %}<p>{{ page.description }}</p>{% endif %}
        </header>

        {% if site.posts and site.posts.size > 0 %}
          {% comment %} Collect all tags from posts first {% endcomment %}
          {% assign all_tags = "" | split: "," %}
          {% for post in site.posts %}
            {% if post.tags %}
              {% for tag in post.tags %}
                {% unless all_tags contains tag %}
                  {% assign all_tags = all_tags | push: tag %}
                {% endunless %}
              {% endfor %}
            {% endif %}
          {% endfor %}
          {% assign sorted_tags = all_tags | sort %}

          {% comment %} Dynamic content area {% endcomment %}
          <div id="posts-container">
            
            {% comment %} Default view - show all posts (most recent first) {% endcomment %}
            <div id="all-posts" class="tag-section">
              <div class="grid-row grid-gap">
                {% assign sorted_posts = site.posts | sort: 'date' | reverse %}
                {% for post in sorted_posts %}
                  <div class="grid-col-12 tablet:grid-col-6 desktop:grid-col-4 margin-bottom-4">
                    {% assign thumb = post.thumbnail | default: "/assets/blog-default.png" %}
                    {% capture post_date %}{{ post.date | date: "%B %-d, %Y" }}{% endcapture %}
                    {% include card.html
                      type='post'
                      title=post.title
                      description=""
                      thumbnail=thumb
                      url=post.url
                      meta=post_date
                      meta_align='center'
                      align='center'
                    %}
                  </div>
                {% endfor %}
              </div>
            </div>

            {% comment %} Individual tag sections {% endcomment %}
            {% for tag in sorted_tags %}
              {% assign tag_posts = site.posts | where_exp: "post", "post.tags contains tag" | sort: 'date' | reverse %}
              {% if tag_posts.size > 0 %}
                <div id="{{ tag | slugify }}-posts" class="tag-section" style="display: none;">
                  <h2>{{ tag | capitalize }}</h2>
                  <p class="text-base-italic margin-bottom-3">{{ tag_posts.size }} post{% if tag_posts.size != 1 %}s{% endif %} tagged with "{{ tag }}" (most recent first)</p>
                  <div class="grid-row grid-gap">
                    {% for post in tag_posts %}
                      <div class="grid-col-12 tablet:grid-col-6 desktop:grid-col-4 margin-bottom-4">
                        {% assign thumb = post.thumbnail | default: "/assets/blog-default.png" %}
                        {% capture post_date %}{{ post.date | date: "%B %-d, %Y" }}{% endcapture %}
                        {% include card.html
                          type='post'
                          title=post.title
                          description=""
                          thumbnail=thumb
                          url=post.url
                          meta=post_date
                          meta_align='center'
                          align='center'
                        %}
                      </div>
                    {% endfor %}
                  </div>
                </div>
              {% endif %}
            {% endfor %}

          </div>
        {% else %}
        <div class="usa-alert usa-alert--info">
          <div class="usa-alert__body">
            <h3 class="usa-alert__heading">Coming Soon</h3>
            <p class="usa-alert__text">No blog posts yet. Check back soon for updates and announcements.</p>
          </div>
        </div>
        {% endif %}
      </main>

      <!-- Right sidebar with tag navigation -->
      <aside class="grid-col-12 tablet:grid-col-3">
        {% if site.posts and site.posts.size > 0 and sorted_tags.size > 0 %}
            <nav class="sidenav-sticky" aria-label="Filter posts by topic">
              <h3 class="margin-top-2">Browse Posts</h3>
              <ul class="usa-sidenav">
                <li class="usa-sidenav__item">
                  <a href="{{ page.url | relative_url }}" data-tag="all" class="blog-tag-link">
                    <div class="blog-tag-item">
                      <span class="blog-tag-name">All Posts</span>
                      <span class="blog-tag-count">({{ site.posts.size }})</span>
                    </div>
                  </a>
                </li>
                {% for tag in sorted_tags %}
                  {% assign tag_posts = site.posts | where_exp: "post", "post.tags contains tag" %}
                  <li class="usa-sidenav__item">
                    <a href="{{ page.url | relative_url }}#{{ tag | slugify }}" data-tag="{{ tag | slugify }}" class="blog-tag-link">
                      <div class="blog-tag-item">
                        <span class="blog-tag-name">{{ tag | capitalize }}</span>
                        <span class="blog-tag-count">({{ tag_posts.size }})</span>
                      </div>
                    </a>
                  </li>
                {% endfor %}
              </ul>
            </nav>
          {% endif %}
        {% endif %}
      </aside>
    </div>
  </div>
</section>

<style>
/* Blog tag sidebar styling */
.blog-tag-link {
  text-decoration: none;
  display: block;
  transition: all 0.2s ease;
}

.blog-tag-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  width: 100%;
}

.blog-tag-name {
  font-weight: 500;
  flex-grow: 1;
}

.blog-tag-count {
  font-size: 0.875rem;
  color: #5c5c5c;
  font-weight: normal;
}

.usa-sidenav__item a.blog-tag-link:hover .blog-tag-count {
  color: inherit;
}

.usa-sidenav__item a.blog-tag-link.active {
  background-color: #0066cc;
  color: white;
  font-weight: 600;
}

.usa-sidenav__item a.blog-tag-link.active .blog-tag-count {
  color: white;
}

.tag-section {
  transition: opacity 0.3s ease;
}

.tag-section.fade-in {
  animation: fadeIn 0.3s ease;
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}

/* Better spacing for tag sections */
#posts-container h2 {
  margin-bottom: 1rem;
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const tagLinks = document.querySelectorAll('.blog-tag-link[data-tag]');
  const tagSections = document.querySelectorAll('.tag-section');
  
  function showTagSection(targetTag) {
    // Hide all sections
    tagSections.forEach(section => {
      section.style.display = 'none';
    });
    
    // Remove active class from all tag links
    tagLinks.forEach(link => {
      link.classList.remove('active');
    });
    
    // Show the target section
    let targetSection;
    if (targetTag === 'all') {
      targetSection = document.getElementById('all-posts');
    } else {
      targetSection = document.getElementById(targetTag + '-posts');
    }
    
    if (targetSection) {
      targetSection.style.display = 'block';
      targetSection.classList.add('fade-in');
      
      // Remove fade-in class after animation
      setTimeout(() => {
        targetSection.classList.remove('fade-in');
      }, 300);
    }
    
    // Add active class to clicked tag
    const activeLink = document.querySelector(`.blog-tag-link[data-tag="${targetTag}"]`);
    if (activeLink) {
      activeLink.classList.add('active');
    }
  }
  
  // Handle tag link clicks
  tagLinks.forEach(link => {
    link.addEventListener('click', function(e) {
      e.preventDefault();
      const targetTag = this.getAttribute('data-tag');
      showTagSection(targetTag);
      
      // Update URL
      if (targetTag === 'all') {
        history.pushState(null, null, window.location.pathname);
      } else {
        history.pushState(null, null, window.location.pathname + '#' + targetTag);
      }
    });
  });
  
  // Handle initial page load with hash
  function initializePage() {
    const hash = window.location.hash.substring(1);
    if (hash && hash !== '') {
      showTagSection(hash);
    } else {
      showTagSection('all');
    }
  }
  
  // Handle browser back/forward buttons
  window.addEventListener('popstate', function() {
    initializePage();
  });
  
  // Initialize page
  initializePage();
});
</script>
